<script>
    const urlParams = new URLSearchParams(window.location.search);
    const shareToken = urlParams.get('code');
    let accessToken = document.cookie.split('=')[1];

    if (accessToken) {
        console.log('accessToken:');
        console.log(accessToken);
        //send shareToken and code to patch /share
        let xhr = new XMLHttpRequest()
        xhr.open('PATCH', `/share`);
        xhr.onreadystatechange = function () {
            if (xhr.readyState == 4) {
                if (xhr.status == 200) {
                    let response = JSON.parse(xhr.responseText)
                    location.assign(`/trip.html?id=${response.tripId}`);
                } else if (xhr.status == 403) {
                    alert(xhr.responseText)
                }
            }
        }
        xhr.setRequestHeader('Content-Type', 'application/json');
        xhr.setRequestHeader('Authorization', `Bearer ${accessToken}`);
        xhr.send(JSON.stringify({shareToken}));
    } else {
        //save shareToken in localstorage
        //redirect to /signin.html
            //in /signin.html & /signup.html, check localstorage if there is share_token
            //if yes, get trip id from backend and redirect to that trip
        
        
    }

</script>